import{a as _,r as h,o as j,b as c,c as d,e,f as D,g as N,v as T,k as B,t as S,h as b,n as m,F as A,j as V,u as $,d as Z,q as E}from"./app-BCejmdRG.js";import{_ as M}from"./Card-COsboz0H.js";import{_ as U}from"./Loading-DduPf9V5.js";const F="/api/courses",R=_.create({baseURL:F}),L=async(l="")=>{try{return(await R.get("/data",{params:{searchTerm:l}})).data.courses}catch(s){throw console.error("Error fetching course data:",s),s}},q="/api/coursesInfo",O=_.create({baseURL:q}),J=async l=>{try{return(await O.get(`/data/${l}`)).data}catch(s){throw console.error("Error fetching course info data:",s),s}},W="/api/favorites",G=_.create({baseURL:W}),H=async l=>{try{return(await G.get(`/data/${l}`)).data}catch(s){throw console.error("Error fetching course info data:",s),s}},K={key:0,class:"min-[560px]:h-[22rem] bg-white h-[24rem] border-b-2 dark:border-gray-600 flex justify-end content-center flex-col shadow-lg dark:bg-zinc-700 dark:text-white"},P=e("p",{class:"text-center text-7xl font-[1000] mb-5"},"Courses",-1),Q={key:0,class:"justify-between grid-cols-2 grid"},X={class:"m-5 grid-cols-1 col-span-2 lg:col-span-1"},Y=e("label",{for:"default-search",class:"mb-2 text-sm font-medium text-gray-900 sr-only"},"Search",-1),ee={class:"relative"},te=e("div",{class:"absolute inset-y-0 start-0 flex items-center ps-3 pointer-events-none"},[e("svg",{class:"w-4 h-4 text-gray-500","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 20 20"},[e("path",{stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"m19 19-4-4m0-7A7 7 0 1 1 1 8a7 7 0 0 1 14 0Z"})])],-1),re={class:"grid-cols-2 flex items-center hidden lg:flex md:items-center"},oe={key:0,class:"block w-full ps-10 p-[8px] text-sm text-gray-900 border border-gray-300 rounded-lg bg-gray-50 focus:ring-blue-500 focus:border-blue-500 mr-5 font-bold flex-row dark:bg-zinc-700 dark:text-white dark:border-gray-600"},se=["href"],ae={class:"ml-8 font-normal"},ne={key:1,class:"flex-col mx-auto mt-3 w-4/5"},le={class:"grid grid-cols-2 min-[560px]:grid-cols-3 auto-rows-max min-[910px]:grid-cols-6 justify-center mb-1"},ie={id:"courses",class:"dark:bg-zinc-700 dark:text-white"},ue={class:"container px-5 py-8 mx-auto sm:px-1"},ce={class:"gap-4 grid grid-flow-row-dense"},de={class:"col-span-3 flex justify-center md:flex md:justify-around"},fe={key:0,class:"grid grid-cols-1 min-[770px]:grid-cols-2 md:grid-cols-2 lg:grid-cols-2 xl:grid-cols-3 xl:m-auto gap-x-[4rem] 2xl:gap-x-36 gap-y-10 justify-items-center items-center"},ge={key:1,class:""},he=e("p",{class:"text-2xl text-black mt-10 text-gray-400"},"No courses found!",-1),be=[he],ye={__name:"Courses",props:{cmid:{type:Number,default:null},coursesMoodle:{type:Object},userId:{type:Number}},setup(l){const s=l,C=s.userId,u=h([]),x=h([]),y=h([]),p=h("");let f=h(!1);const n=h("default");j(async()=>{try{s.coursesMoodle!=null?(f.value=!0,u.value=s.coursesMoodle,f.value=!1):(f.value=!0,u.value=await L(),x.value=await J(C),y.value=await H(C),f.value=!1,I())}catch(a){console.error("Error fetching course data:",a),f.value=!1}});async function z(){try{u.value=await L(p.value),I()}catch(a){console.error("Error filtering course data:",a)}}function w(){const a=localStorage.getItem("last_visited_course");return a?JSON.parse(a):null}function I(){const a=x.value.courseInfo,t=y.value.favorites;Array.isArray(a)&&Array.isArray(t)?u.value=u.value.map(r=>{const o=a.find(v=>v.course_id===r.id),i=t.find(v=>v.course_id===r.id);return{...r,progress:o?o.progress:null,favorite:!!i}}).sort((r,o)=>r.favorite&&!o.favorite?-1:!r.favorite&&o.favorite?1:0):console.log("Course info data or favorites data is not an array:",a,t)}const g=a=>{const t=x.value.courseInfo,r=y.value.favorites;n.value=a,Array.isArray(t)&&Array.isArray(r)?u.value=u.value.map(o=>{const i=t.find(k=>k.course_id===o.id),v=r.find(k=>k.course_id===o.id);return{...o,progress:i?i.progress:null,favorite:!!v}}).sort((o,i)=>{switch(a){case"default":if(o.favorite&&!i.favorite)return-1;if(!o.favorite&&i.favorite)return 1;case"length":return i.name.length-o.name.length;case"shortest":return o.name.length-i.name.length;case"alphabeticalA":return o.name.localeCompare(i.name);case"alphabeticalZ":return i.name.localeCompare(o.name);case"date":return new Date(i.created_at)-new Date(o.created_at);default:return console.error("Invalid criteria:",a),0}}):console.error("Course info data or favorites data is not an array:",t,r)};return(a,t)=>(c(),d(A,null,[l.cmid==null?(c(),d("section",K,[P,l.cmid==null?(c(),d("div",Q,[e("div",X,[e("form",{class:"mx-auto",onSubmit:D(z,["prevent"])},[Y,e("div",ee,[te,N(e("input",{type:"search",id:"default-search","onUpdate:modelValue":t[0]||(t[0]=r=>p.value=r),onInput:z,class:"block w-full ps-10 text-sm text-gray-900 border border-gray-300 rounded-lg bg-gray-50 focus:ring-blue-500 focus:border-blue-500 dark:bg-zinc-600 dark:border-gray-600 dark:text-gray-200",placeholder:"Search...",required:""},null,544),[[T,p.value]])])],32)]),e("div",re,[w()!=null?(c(),d("p",oe,[B(" Last visited "),e("a",{href:"/course/"+w().id},[e("span",ae,S(w().name),1)],8,se)])):b("",!0)])])):b("",!0),l.cmid==null?(c(),d("div",ne,[e("div",le,[e("button",{onClick:t[1]||(t[1]=r=>g("default")),class:m([{"bg-blue-700 dark:text-white text-white hover:bg-blue-700 hover:text-white":n.value==="default","bg-white dark:bg-zinc-700 dark:text-white text-gray-900  hover:bg-gray-100 hover:text-blue-700":n.value!=="default"},"py-1.5 px-8 me-2 mb-2 text-sm font-medium focus:outline-none rounded-full border border-blue-700 focus:z-10 focus:ring-gray-100"])},"Default",2),e("button",{onClick:t[2]||(t[2]=r=>g("length")),class:m([{"bg-blue-700  dark:text-white text-white hover:bg-blue-700 hover:text-white":n.value==="length","bg-white dark:bg-zinc-700 dark:text-white text-gray-900 hover:bg-gray-100 hover:text-blue-700":n.value!=="length"},"py-1.5 px-8 me-2 mb-2 text-sm font-medium focus:outline-none rounded-full border border-blue-700 focus:z-10 focus:ring-gray-100"])},"Longest",2),e("button",{onClick:t[3]||(t[3]=r=>g("shortest")),class:m([{"bg-blue-700  dark:text-white text-white hover:bg-blue-700 hover:text-white":n.value==="shortest","bg-white dark:bg-zinc-700 dark:text-white text-gray-900  hover:bg-gray-100 hover:text-blue-700":n.value!=="shortest"},"py-1.5 px-8 me-2 mb-2 text-sm font-medium focus:outline-none rounded-full border border-blue-700 focus:z-10 focus:ring-gray-100"])},"Shortest",2),e("button",{onClick:t[4]||(t[4]=r=>g("alphabeticalA")),class:m([{"bg-blue-700  dark:text-white-700 text-white hover:bg-blue-700 hover:text-white":n.value==="alphabeticalA","bg-white dark:bg-zinc-700 dark:text-white text-gray-900  hover:bg-gray-100 hover:text-blue-700":n.value!=="alphabeticalA"},"py-1.5 px-8 me-2 mb-2 text-sm font-medium focus:outline-none rounded-full border border-blue-700 focus:z-10 focus:ring-gray-100"])},"A to Z",2),e("button",{onClick:t[5]||(t[5]=r=>g("alphabeticalZ")),class:m([{"bg-blue-700  dark:text-white-700 text-white hover:bg-blue-700 hover:text-white":n.value==="alphabeticalZ","bg-white dark:bg-zinc-700 dark:text-white text-gray-900  hover:bg-gray-100 hover:text-blue-700":n.value!=="alphabeticalZ"},"py-1.5 px-8 me-2 mb-2 text-sm font-medium focus:outline-none rounded-full border border-blue-700 focus:z-10 focus:ring-gray-100"])},"Z to A",2),e("button",{onClick:t[6]||(t[6]=r=>g("date")),class:m([{"bg-blue-700 dark:text-white text-white hover:bg-blue-700 hover:text-white":n.value==="date","bg-white dark:bg-zinc-700 dark:text-white text-gray-900 hover:bg-gray-100 hover:text-blue-700":n.value!=="date"},"py-1.5 px-8 me-2 mb-2 text-sm font-medium focus:outline-none rounded-full border border-blue-700 focus:z-10 focus:ring-gray-100"])},"Date",2)])])):b("",!0)])):b("",!0),e("section",ie,[e("div",ue,[e("div",ce,[e("div",de,[u.value.length>0?(c(),d("div",fe,[(c(!0),d(A,null,V(u.value,r=>(c(),E(M,{course:r,cmid:l.cmid?l.cmid:null},null,8,["course","cmid"]))),256))])):b("",!0),u.value.length==0&&$(f)==!1?(c(),d("div",ge,be)):b("",!0)])])])]),Z(U,{loading:$(f)},null,8,["loading"])],64))}};export{ye as _};
